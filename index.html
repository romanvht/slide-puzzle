<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Пазлы</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" media="screen" href="css/style.css?ver=1.2.19">
  <script>
    /**** Костыль для SDK ****/
    let domain = document.domain;
    
    if (domain.indexOf("yandex") !== -1) {
      window.localStorage.setItem('mode', 'yandex');

      var sdk = document.createElement('script');
      sdk.src = 'https://yandex.ru/games/sdk/v2';
      document.getElementsByTagName('head')[0].appendChild(sdk);
    }
    /**** /Костыль для SDK ****/

    window.onload = function () {
      var preloader = document.getElementById('p_prldr');
      preloader.classList.add('fadeout');

      setTimeout(function () {
        preloader.parentNode.removeChild(preloader);
      }, 200);

      /**** Костыль для SDK ****/
      if (window.localStorage.getItem('mode') == 'yandex') {
        YaGames.init().then(ysdk => {
          ysdk.features.LoadingAPI?.ready();
        });
      }
      /**** /Костыль для SDK ****/
    };
  </script>
</head>

<body>
  <div id="p_prldr">
    <svg width="38" height="38" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
      <g fill="none" fill-rule="evenodd">
          <g transform="translate(1 1)" stroke-width="2">
              <circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
              <path d="M36 18c0-9.94-8.06-18-18-18"/>
          </g>
      </g>
    </svg>
  </div>

  <div class="menu"></div>

  <div class="game">
    <div class="message">
      <div class="message-body">
        <div class="message-title">
          Победа!
        </div>
        <div class="message-text">
          Вы отлично справились!
          <div class="message-control">
            <a href="index.html" class="next-button">
              Далее
            </a>
            <a href="#" class="download-button" download>
              Скачать
            </a>
          </div>
          <div class="message-small">Сейчас будет показана реклама</div>
        </div>
      </div>
    </div>

    <div class="game-info">
      <div class="game-info_box steps-count">
        Ходов
        <span class="steps-count_info">0</span>
      </div>
      <a onclick="muteGame()" href="#" class="game-info_box sound-button">
        <img src="img/sound/on.svg" alt="sound on">
      </a>
    </div>

    <div id="tiles"></div>

    <div class="game-control">
      <a href="index.html" class="menu-button">
        Меню
      </a>
      <a onclick="restartGame()" href="#" class="restart-button">
        Рестарт
      </a>
    </div>
  </div>
  <audio id="sound">
    <source src="mp3/click.mp3" type="audio/mp3">
  </audio>
  <script src="js/levels.js?ver=1.2.19"></script>
  <script src="js/game.js?ver=1.2.19"></script>
  <script>
    if ($_GET('level')) {
      let storage = window.localStorage;
      let category = storage.getItem('category');
      let level = $_GET('level');

      let menu = document.querySelector('.menu');
      menu.style.display = "none";

      let game = document.querySelector('.game');
      game.style.display = "flex";

      size = levels[level].size;
      gameImage = 'img/' + categories[category].folder + '/' + levels[level].image;

      newGame(level, size, gameImage);
    } else if ($_GET('cat')) {
      let getcategory = $_GET('cat');

      getLevels(getcategory);
    } else {
      getLinks();
    }
  </script>
</body>

</html>